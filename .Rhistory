file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20000101")
sh_pee <- NULL
daily_data <- NULL
stock_n_list <- stock_list
for(stockno in stock_n_list){
cat("  Doing stockno", stockno, "\n")
ttime <- as.character(as.integer(as.POSIXct(Sys.time()))*100)
historyStock <- NULL
sh_pe <- NULL
for(date_1 in date_set){
Sys.sleep(runif(1,2,4))#randomly delay 1 time between 2 and 3 seconds
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
source("func.R"); sh_pe <- show_percet_len(sh_pe, date_1, date_set)
}
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
historyStock <- rbind(c("nono", "Volume", "Value", "Price"), historyStock)
colnames(historyStock) <- c("Date", paste0(stockno,"_vo"), paste0(stockno,"_va"), paste0(stockno,"_pr"))
if(is.null(daily_data)){daily_data <- historyStock}else{daily_data <- merge(daily_data, historyStock,  by="Date", all = TRUE)}
historyStock_1 <- c(historyStock$nono, historyStock$Volume)
historyStock_2 <- c(historyStock$nono, historyStock$Value)
historyStock_3 <- c(historyStock$nono, historyStock$Price)
if(is.null(daily_data_1)){daily_data_1 <- historyStock_1}else{daily_data_1 <- merge(daily_data_1, historyStock_1,  by="Date", all = TRUE)}
if(is.null(daily_data_2)){daily_data_2 <- historyStock_2}else{daily_data_2 <- merge(daily_data_2, historyStock_2,  by="Date", all = TRUE)}
if(is.null(daily_data_3)){daily_data_3 <- historyStock_3}else{daily_data_3 <- merge(daily_data_3, historyStock_3,  by="Date", all = TRUE)}
source("func.R"); sh_pee <- show_percet_len(sh_pee, stockno, stock_n_list)
}
cat("  Doing stockno", stockno, "\n")
ttime <- as.character(as.integer(as.POSIXct(Sys.time()))*100)
historyStock <- NULL
sh_pe <- NULL
Sys.sleep(runif(1,2,4))#randomly delay 1 time between 2 and 3 seconds
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
source("func.R"); sh_pe <- show_percet_len(sh_pe, date_1, date_set)
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
historyStock <- rbind(c("nono", "Volume", "Value", "Price"), historyStock)
colnames(historyStock) <- c("Date", paste0(stockno,"_vo"), paste0(stockno,"_va"), paste0(stockno,"_pr"))
View(historyStock)
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
historyStock <- rbind(c("nono", "Volume", "Value", "Price"), historyStock)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
historyStock <- NULL
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
# historyStock <- rbind(c("nono", "Volume", "Value", "Price"), historyStock)
colnames(historyStock) <- c("Date", paste0(stockno,"_vo"), paste0(stockno,"_va"), paste0(stockno,"_pr"))
historyStock_1 <- c(historyStock$Date, historyStock[,2])
historyStock_1
historyStock[,2]
historyStock_1 <- c(historyStock[,1], historyStock[,2])
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
View(historyStock_1)
historyStock[,1]
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
historyStock <- NULL
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
source("func.R"); historyStock_1[, 1] <- year_change_108_to_2019( as.Date(historyStock_1[, 1]) )
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
# source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
historyStock_2 <- cbind(historyStock[,1], historyStock[,3])
historyStock_3 <- cbind(historyStock[,1], historyStock[,4])
colnames(historyStock_1) <- c("Date", paste0(stockno))
colnames(historyStock_2) <- c("Date", paste0(stockno))
colnames(historyStock_3) <- c("Date", paste0(stockno))
View(historyStock_2)
colnames(historyStock_1) <- c("Date", paste0(stockno))
View(historyStock_1)
source("func.R"); historyStock_1[, 1] <- year_change_108_to_2019( as.Date(historyStock_1[, 1]) )
stock_data_1 <- xts(historyStock_1[, -1], order.by = as.Date(historyStock_1[, 1]))
stock_data_1 <- xts(historyStock_1[, -1], order.by = year_change_108_to_2019( as.Date(historyStock_1[, 1]) ))
View(historyStock)
View(historyStock_1)
View(historyStock_2)
View(historyStock)
View(historyStock_2)
historyStock[,1]
as.Date(historyStock[, 1])
year_change_108_to_2019( as.Date(historyStock[, 1]) )
stock_data_1 <- xts(historyStock_1[, -1], order.by = year_change_108_to_2019( as.Date(historyStock[, 1])))
View(stock_data_1)
stock_data_1 <- xts(historyStock_1[, -1], order.by = year_change_108_to_2019( as.Date(historyStock[, 1])))
View(stock_data_1)
historyStock_1[, -1]
View(historyStock_1)
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
colnames(historyStock_1) <- c("Date", paste0(stockno))
View(historyStock_1)
stock_data_1 <- xts(historyStock_1[, -1], order.by = year_change_108_to_2019( as.Date(historyStock[, 1])))
View(stock_data_1)
stock_data_1 <- xts(historyStock_1[, -1], order.by = year_change_108_to_2019( as.Date(historyStock_1[, 1])))
View(stock_data_1)
View(historyStock_1)
file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20000101")
sh_pee <- NULL
daily_data_1 <- NULL
daily_data_2 <- NULL
daily_data_3 <- NULL
cat("  Doing stockno", stockno, "\n")
ttime <- as.character(as.integer(as.POSIXct(Sys.time()))*100)
historyStock <- NULL
sh_pe <- NULL
Sys.sleep(runif(1,2,4))#randomly delay 1 time between 2 and 3 seconds
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
# source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
historyStock_2 <- cbind(historyStock[,1], historyStock[,3])
historyStock_3 <- cbind(historyStock[,1], historyStock[,4])
colnames(historyStock_1) <- c("Date", paste0(stockno))
colnames(historyStock_2) <- c("Date", paste0(stockno))
colnames(historyStock_3) <- c("Date", paste0(stockno))
if(is.null(daily_data_1)){daily_data_1 <- historyStock_1}else{daily_data_1 <- merge(daily_data_1, historyStock_1,  by="Date", all = TRUE)}
if(is.null(daily_data_2)){daily_data_2 <- historyStock_2}else{daily_data_2 <- merge(daily_data_2, historyStock_2,  by="Date", all = TRUE)}
if(is.null(daily_data_3)){daily_data_3 <- historyStock_3}else{daily_data_3 <- merge(daily_data_3, historyStock_3,  by="Date", all = TRUE)}
stock_data_1 <- xts(historyStock_1[, -1], order.by = year_change_108_to_2019( as.Date(historyStock_1[, 1])))
stock_data_2 <- xts(historyStock_2[, -1], order.by = year_change_108_to_2019( as.Date(historyStock_2[, 1])))
stock_data_3 <- xts(historyStock_3[, -1], order.by = year_change_108_to_2019( as.Date(historyStock_3[, 1])))
View(stock_data_2)
View(daily_data_1)
stock_data_1 <- xts(daily_data_1[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_1[, 1])))
stock_data_2 <- xts(daily_data_2[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_2[, 1])))
stock_data_3 <- xts(daily_data_3[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_3[, 1])))
View(daily_data_1)
View(daily_data_3)
file_name <- paste0(file_path,"Volumn.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, historyStock_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(historyStock, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Value.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_2, historyStock_2)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(historyStock, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Price.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_3, historyStock_3)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(historyStock, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Value.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_2, daily_data_2)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(historyStock, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Price.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_3, daily_data_3)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(historyStock, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
# rm(sh_pee, stockno, sh_pe, stock_data, file_name)
# rm(tmpStock, jsondata, date_1, ttime, url_1, historyStock)
cat("All Done\n")
file_name <- paste0(file_path,"Volumn.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, daily_data_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(historyStock, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Volumn.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, daily_data_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_1, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Value.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_2, daily_data_2)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_2, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Price.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_3, daily_data_3)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_3, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Volumn.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, daily_data_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_1, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Value.csv")
if(file.exists(file_name)){
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_2, daily_data_2)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_2, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
file_name <- paste0(file_path,"Volumn.csv")
############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
View(read_csv_to_xts)
############### read files ############################
rcsv <- read.csv(file_name)
View(rcsv)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
View(rcsv)
library(xlsx)
install.packages(xlsx)
install.packages('xlsx')
library(xlsx)
library("xlsx")
#install.packages( c("jsonlite", "lubridate", "quantmod"))
library(quantmod)
install.packages('xlsx')
library(xlsx)
library(xlsx)
library(readxl)
library(xlsx)#need to download java
Sys.setenv(JAVA_HOME='D:\\Java\\jdk-12.0.1')
library(xlsx)#need to download java
library(XLConnect)
install.packages("XLConnect")
library(XLConnect)
file_path <- paste0(getwd(), "/data_DOHLCV/")
file_name <- paste0(file_path,"Price.csv")
loadWorkbook(file_name)
file_name
file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20000101")
sh_pee <- NULL
daily_data_1 <- NULL
daily_data_2 <- NULL
daily_data_3 <- NULL
cat("  Doing stockno", stockno, "\n")
ttime <- as.character(as.integer(as.POSIXct(Sys.time()))*100)
historyStock <- NULL
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
library(quantmod)
library(lubridate)
library(jsonlite)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 4:7],
jsondata$data[, 2:3],
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
# source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
historyStock_2 <- cbind(historyStock[,1], historyStock[,3])
historyStock_3 <- cbind(historyStock[,1], historyStock[,4])
colnames(historyStock_1) <- c("Date", paste0(stockno))
colnames(historyStock_2) <- c("Date", paste0(stockno))
colnames(historyStock_3) <- c("Date", paste0(stockno))
if(is.null(daily_data_1)){daily_data_1 <- historyStock_1}else{daily_data_1 <- merge(daily_data_1, historyStock_1,  by="Date", all = TRUE)}
if(is.null(daily_data_2)){daily_data_2 <- historyStock_2}else{daily_data_2 <- merge(daily_data_2, historyStock_2,  by="Date", all = TRUE)}
if(is.null(daily_data_3)){daily_data_3 <- historyStock_3}else{daily_data_3 <- merge(daily_data_3, historyStock_3,  by="Date", all = TRUE)}
stock_data_1 <- xts(daily_data_1[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_1[, 1])))
stock_data_2 <- xts(daily_data_2[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_2[, 1])))
stock_data_3 <- xts(daily_data_3[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_3[, 1])))
file_name <- paste0(file_path,"Volumn.xls")
if(file.exists(file_name)){
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, daily_data_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_1, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
loadWorkbook(file_name)
file_name
file_name <- paste0(file_path,"Volumn.xlsx")
if(file.exists(file_name)){
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, daily_data_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_1, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
loadWorkbook(file_name)
file_name <- paste0(file3_path,"Volumn.csv")
file_name <- paste0(file_path,"Volumn.csv")
getSheets(file_name)
