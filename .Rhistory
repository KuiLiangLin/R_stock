############### read files ############################
source("func.R"); rcsv_xts <- read_csv_to_xts(file_name)
View(read_csv_to_xts)
############### read files ############################
rcsv <- read.csv(file_name)
View(rcsv)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
View(rcsv)
library(xlsx)
install.packages(xlsx)
install.packages('xlsx')
library(xlsx)
library("xlsx")
#install.packages( c("jsonlite", "lubridate", "quantmod"))
library(quantmod)
install.packages('xlsx')
library(xlsx)
library(xlsx)
library(readxl)
library(xlsx)#need to download java
Sys.setenv(JAVA_HOME='D:\\Java\\jdk-12.0.1')
library(xlsx)#need to download java
library(XLConnect)
install.packages("XLConnect")
library(XLConnect)
file_path <- paste0(getwd(), "/data_DOHLCV/")
file_name <- paste0(file_path,"Price.csv")
loadWorkbook(file_name)
file_name
file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20000101")
sh_pee <- NULL
daily_data_1 <- NULL
daily_data_2 <- NULL
daily_data_3 <- NULL
cat("  Doing stockno", stockno, "\n")
ttime <- as.character(as.integer(as.POSIXct(Sys.time()))*100)
historyStock <- NULL
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
library(quantmod)
library(lubridate)
library(jsonlite)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 4:7],
jsondata$data[, 2:3],
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
# source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
historyStock_2 <- cbind(historyStock[,1], historyStock[,3])
historyStock_3 <- cbind(historyStock[,1], historyStock[,4])
colnames(historyStock_1) <- c("Date", paste0(stockno))
colnames(historyStock_2) <- c("Date", paste0(stockno))
colnames(historyStock_3) <- c("Date", paste0(stockno))
if(is.null(daily_data_1)){daily_data_1 <- historyStock_1}else{daily_data_1 <- merge(daily_data_1, historyStock_1,  by="Date", all = TRUE)}
if(is.null(daily_data_2)){daily_data_2 <- historyStock_2}else{daily_data_2 <- merge(daily_data_2, historyStock_2,  by="Date", all = TRUE)}
if(is.null(daily_data_3)){daily_data_3 <- historyStock_3}else{daily_data_3 <- merge(daily_data_3, historyStock_3,  by="Date", all = TRUE)}
stock_data_1 <- xts(daily_data_1[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_1[, 1])))
stock_data_2 <- xts(daily_data_2[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_2[, 1])))
stock_data_3 <- xts(daily_data_3[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_3[, 1])))
file_name <- paste0(file_path,"Volumn.xls")
if(file.exists(file_name)){
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, daily_data_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_1, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
loadWorkbook(file_name)
file_name
file_name <- paste0(file_path,"Volumn.xlsx")
if(file.exists(file_name)){
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, daily_data_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_1, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
loadWorkbook(file_name)
file_name <- paste0(file3_path,"Volumn.csv")
file_name <- paste0(file_path,"Volumn.csv")
getSheets(file_name)
#
library(xlsx)#need to download java
#
library(rJava)
library(xlsx)#need to download java
library(quantmod)
library(lubridate)
library(jsonlite)
file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20000101")
sh_pee <- NULL
daily_data_1 <- NULL
daily_data_2 <- NULL
daily_data_3 <- NULL
cat("  Doing stockno", stockno, "\n")
ttime <- as.character(as.integer(as.POSIXct(Sys.time()))*100)
historyStock <- NULL
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
# historyStock <- rbind(c("nono", "Volume", "Value", "Price"), historyStock)
# colnames(historyStock) <- c("Date", paste0(stockno,"_vo"), paste0(stockno,"_va"), paste0(stockno,"_pr"))
# if(is.null(daily_data)){daily_data <- historyStock}else{daily_data <- merge(daily_data, historyStock,  by="Date", all = TRUE)}
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
historyStock_2 <- cbind(historyStock[,1], historyStock[,3])
historyStock_3 <- cbind(historyStock[,1], historyStock[,4])
colnames(historyStock_1) <- c("Date", paste0(stockno))
colnames(historyStock_2) <- c("Date", paste0(stockno))
colnames(historyStock_3) <- c("Date", paste0(stockno))
# source("func.R"); historyStock_1[, 1] <- year_change_108_to_2019( as.Date(historyStock_1[, 1]) )
if(is.null(daily_data_1)){daily_data_1 <- historyStock_1}else{daily_data_1 <- merge(daily_data_1, historyStock_1,  by="Date", all = TRUE)}
if(is.null(daily_data_2)){daily_data_2 <- historyStock_2}else{daily_data_2 <- merge(daily_data_2, historyStock_2,  by="Date", all = TRUE)}
if(is.null(daily_data_3)){daily_data_3 <- historyStock_3}else{daily_data_3 <- merge(daily_data_3, historyStock_3,  by="Date", all = TRUE)}
stock_data_1 <- xts(daily_data_1[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_1[, 1])))
stock_data_2 <- xts(daily_data_2[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_2[, 1])))
stock_data_3 <- xts(daily_data_3[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_3[, 1])))
# source("func.R"); historyStock_1[, 1] <- year_change_108_to_2019( as.Date(historyStock_1[, 1]) )
source("func.R")
if(is.null(daily_data_1)){daily_data_1 <- historyStock_1}else{daily_data_1 <- merge(daily_data_1, historyStock_1,  by="Date", all = TRUE)}
if(is.null(daily_data_2)){daily_data_2 <- historyStock_2}else{daily_data_2 <- merge(daily_data_2, historyStock_2,  by="Date", all = TRUE)}
if(is.null(daily_data_3)){daily_data_3 <- historyStock_3}else{daily_data_3 <- merge(daily_data_3, historyStock_3,  by="Date", all = TRUE)}
stock_data_1 <- xts(daily_data_1[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_1[, 1])))
stock_data_2 <- xts(daily_data_2[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_2[, 1])))
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
historyStock_2 <- cbind(historyStock[,1], historyStock[,3])
historyStock_3 <- cbind(historyStock[,1], historyStock[,4])
colnames(historyStock_1) <- c("Date", paste0(stockno))
colnames(historyStock_2) <- c("Date", paste0(stockno))
colnames(historyStock_3) <- c("Date", paste0(stockno))
# source("func.R"); historyStock_1[, 1] <- year_change_108_to_2019( as.Date(historyStock_1[, 1]) )
source("func.R")
if(is.null(daily_data_1)){daily_data_1 <- historyStock_1}else{daily_data_1 <- merge(daily_data_1, historyStock_1,  by="Date", all = TRUE)}
if(is.null(daily_data_2)){daily_data_2 <- historyStock_2}else{daily_data_2 <- merge(daily_data_2, historyStock_2,  by="Date", all = TRUE)}
if(is.null(daily_data_3)){daily_data_3 <- historyStock_3}else{daily_data_3 <- merge(daily_data_3, historyStock_3,  by="Date", all = TRUE)}
stock_data_1 <- xts(daily_data_1[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_1[, 1])))
stock_data_2 <- xts(daily_data_2[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_2[, 1])))
stock_data_3 <- xts(daily_data_3[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_3[, 1])))
file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20000101")
sh_pee <- NULL
daily_data_1 <- NULL
daily_data_2 <- NULL
daily_data_3 <- NULL
file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20000201")
sh_pee <- NULL
daily_data_1 <- NULL
daily_data_2 <- NULL
daily_data_3 <- NULL
cat("  Doing stockno", stockno, "\n")
ttime <- as.character(as.integer(as.POSIXct(Sys.time()))*100)
historyStock <- NULL
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
View(jsondata)
file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20060101")
sh_pee <- NULL
daily_data_1 <- NULL
daily_data_2 <- NULL
daily_data_3 <- NULL
historyStock <- NULL
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
View(jsondata)
url_1
file_path <- paste0(getwd(), "/data_DOHLCV/")
stockno <- c("1101")
date_1 <- c("20100101")
sh_pee <- NULL
daily_data_1 <- NULL
daily_data_2 <- NULL
daily_data_3 <- NULL
url_1 <- paste0('http://www.tse.com.tw/exchangeReport/STOCK_DAY?',
'response=json&date=',date_1,'&stockNo=',stockno,'&_=',ttime)
jsondata <- fromJSON(url_1)
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
if(jsondata$stat == "OK"){
tmpStock <- data.frame(jsondata$data[, 1],
jsondata$data[, 2:3],
NA,
stringsAsFactors = FALSE)
historyStock <- rbind(historyStock, tmpStock)
}
# colnames(historyStock) <- c("Date", "Volume", "Value", "Close")
# source("func.R"); historyStock[, 1] <- year_change_108_to_2019( as.Date(historyStock[, 1]) )
historyStock[,2] <- as.numeric(gsub(',', replacement = '', historyStock[,2]))
historyStock[,3] <- as.numeric(gsub(',', replacement = '', historyStock[,3]))
historyStock[,4] <- round(historyStock[,3] / historyStock[,2], 2)
# historyStock <- rbind(c("nono", "Volume", "Value", "Price"), historyStock)
# colnames(historyStock) <- c("Date", paste0(stockno,"_vo"), paste0(stockno,"_va"), paste0(stockno,"_pr"))
# if(is.null(daily_data)){daily_data <- historyStock}else{daily_data <- merge(daily_data, historyStock,  by="Date", all = TRUE)}
historyStock_1 <- cbind(historyStock[,1], historyStock[,2])
historyStock_2 <- cbind(historyStock[,1], historyStock[,3])
historyStock_3 <- cbind(historyStock[,1], historyStock[,4])
colnames(historyStock_1) <- c("Date", paste0(stockno))
colnames(historyStock_2) <- c("Date", paste0(stockno))
colnames(historyStock_3) <- c("Date", paste0(stockno))
# source("func.R"); historyStock_1[, 1] <- year_change_108_to_2019( as.Date(historyStock_1[, 1]) )
source("func.R")
if(is.null(daily_data_1)){daily_data_1 <- historyStock_1}else{daily_data_1 <- merge(daily_data_1, historyStock_1,  by="Date", all = TRUE)}
if(is.null(daily_data_2)){daily_data_2 <- historyStock_2}else{daily_data_2 <- merge(daily_data_2, historyStock_2,  by="Date", all = TRUE)}
if(is.null(daily_data_3)){daily_data_3 <- historyStock_3}else{daily_data_3 <- merge(daily_data_3, historyStock_3,  by="Date", all = TRUE)}
stock_data_1 <- xts(daily_data_1[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_1[, 1])))
stock_data_2 <- xts(daily_data_2[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_2[, 1])))
stock_data_3 <- xts(daily_data_3[, -1], order.by = year_change_108_to_2019( as.Date(daily_data_3[, 1])))
View(daily_data_1)
file_name <- paste0(file_path,"Volumn.csv")
############### read files ############################
rcsv <- read.csv(file_name)
View(rcsv)
a <- merge(daily_data_1, rcsv, by="Date", all = TRUE)
View(a)
View(rcsv)
colnames(rcsv)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X', replacement = '',colnames(rcsv))
colnames(rcsv)
a <- merge(daily_data_1, rcsv, by="Date", all = TRUE)
View(a)
View(daily_data_1)
View(rcsv)
a <- rbind(rcsv, daily_data_1)
View(a)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X1', replacement = '',colnames(rcsv))
colnames(rcsv)
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X1', replacement = '',colnames(rcsv))
colnames(rcsv)
a <- rbind(rcsv, daily_data_1)
a <- merge(daily_data_1, rcsv, by="Date", all = TRUE)
View(a)
a <- merge(daily_data_1, rcsv, by="Date", all = FLASE)
a <- merge(daily_data_1, rcsv, by="Date", all = FALSE)
View(a)
library(plyr)
a <- rbind.fill(rcsv, daily_data_1)
data.frame(rcsv)
install.packages("magrittr")
a <- rbind.fill(data.frame(rcsv), data.frame(daily_data_1))
View(a)
library(magrittr)
a <- rbind.fill(rcsv%>%data.frame, daily_data_1%>%data.frame)
colnames(rcsv)%<>%gsub('X1', replacement = '')
colnames(rcsv)%<>%gsub('X1', replacement = '',.)
View(a)
colnames(a) %<>% gsub('X1', replacement = '',.)
View(a)
############### read files ############################
rcsv <- read.csv(file_name)
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X1', replacement = '',colnames(rcsv))
a <- rbind.fill(rcsv%>%data.frame, daily_data_1%>%data.frame)
colnames(a) %<>% gsub('X', replacement = '',.)
View(a)
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X', replacement = '',colnames(rcsv))
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
# a <- merge(daily_data_1, rcsv, by="Date", all = TRUE)
a <- rbind.fill(data.frame(rcsv), data.frame(daily_data_1))
a <- rbind.fill(rcsv%>%data.frame, daily_data_1%>%data.frame)
colnames(a) %<>% gsub('X', replacement = '',.)
View(a)
View(daily_data_1)
############### read files ############################
rcsv <- read.csv(file_name)
View(rcsv)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X', replacement = '',colnames(rcsv))
a <- rbind.fill(rcsv%>%data.frame, daily_data_1%>%data.frame)
View(a)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
# a <- merge(daily_data_1, rcsv, by="Date", all = TRUE)
a <- rbind.fill(data.frame(rcsv), data.frame(daily_data_1))
View(a)
View(daily_data_1)
View(rcsv)
a <- rbind.fill(rcsv%>%data.frame, daily_data_1%>%data.frame)
View(a)
View(daily_data_1)
data.frame(rcsv)
data.frame(daily_data_1)
rbind.fill(data.frame(rcsv), data.frame(daily_data_1))
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(daily_data_1, rcsv, by="Date", all = TRUE)
View(a)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(daily_data_1 >%> t, rcsv, by="Date", all = TRUE)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(daily_data_1%>%t, rcsv%>%t, by="Date", all = TRUE)
daily_data_1%>%t
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(daily_data_1%>%t, rcsv%>%t, by=row, all = TRUE)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(daily_data_1%>%t, rcsv%>%t, all = TRUE)
View(a)
rcsv_55 <- cbind(colnames(rcsv), rcsv)
View(rcsv_55)
rcsv_55 <- rbind(colnames(rcsv), rcsv)
colnames(rcsv)
colnames(rcsv)[1]
rcsv_55 <- rbind(c("no",colnames(rcsv)[2]), rcsv)
c("no",colnames(rcsv)[2])
rcsv
rcsv_55 <- rbind(c("555",colnames(rcsv)[2]), rcsv)
rcsv_55 <- rbind(c(colnames(rcsv)[2],colnames(rcsv)[2]), rcsv)
rcsv_55 <- rbind(c("no",colnames(rcsv)[2]), rcsv%>%data.frame)
rcsv_55 <- rbind(c("no",colnames(rcsv)[2])%>%data.frame, rcsv%>%data.frame)
rcsv_55 <- rbind(c("no",colnames(rcsv)[2]), rcsv%>%data.frame)
rcsv%>%t
rcsv_55 <- rbind(rcsv%>%t%>%rownames, rcsv%>%t)
View(rcsv_55)
rcsv_55 <- cbind(rcsv%>%t%>%rownames, rcsv%>%t)
View(rcsv_55)
daily_data_1_55 <- cbind(daily_data_1%>%t%>%rownames, daily_data_1%>%t)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv_55, daily_data_1_55%>%t, by="Date", all = TRUE)
View(rcsv_55)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv_55, daily_data_1_55%>%t, by="V1", all = TRUE)
View(daily_data_1)
View(daily_data_3)
View(daily_data_1_55)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv_55, daily_data_1_55%>%t, by="V1", all = TRUE)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv_55, daily_data_1_55%>%t, by=rcsv_55$V1, all = TRUE)
rcsv_55$V1
rcsv_55[1,]
rcsv_55[,1]
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv_55, daily_data_1_55%>%t, by=rcsv_55[,1], all = TRUE)
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv_55%>%data.frame, daily_data_1_55%>%t%>%data.frame, by="V1", all = TRUE)
rcsv_55%>%data.frame
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv_55%>%data.frame, daily_data_1_55%>%t%>%data.frame, by="X1", all = TRUE)
rcsv_55%>%colnames
rcsv_55
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv_55%>%colnames, daily_data_1_55%>%t, by=[,1], all = TRUE)
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X', replacement = '',colnames(rcsv))
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- rbind.fill(data.frame(rcsv), data.frame(daily_data_1))
View(a)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X1', replacement = '',colnames(rcsv))
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- rbind.fill(data.frame(rcsv), data.frame(daily_data_1))
View(a)
View(rcsv)
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X1', replacement = '',colnames(rcsv))
a <- rbind.fill(rcsv%>%data.frame, daily_data_1%>%data.frame)
View(a)
a <- merge(rcsv%>%data.frame, daily_data_1%>%data.frame)
a <- merge(rcsv%>%data.frame, daily_data_1%>%data.frame, all=TRUE)
View(a)
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X', replacement = '',colnames(rcsv))
a <- merge(rcsv%>%data.frame, daily_data_1%>%data.frame, all=TRUE)
View(a)
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X1', replacement = '',colnames(rcsv))
a <- merge(rcsv%>%data.frame, daily_data_1%>%data.frame, all=TRUE)
View(a)
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X1', replacement = '',colnames(rcsv))
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv%>%data.frame, daily_data_1%>%data.frame, all=TRUE)
a[is.na(a)] <- 0
colnames(a) %<>% gsub('X', replacement = '',.)
View(a)
a%<>%t
a[is.na(a)] <- 0
View(a)
a%<>%t
View(a)
colnames(a) %<>% gsub('X', replacement = '',.)
View(a)
library(quantmod)
library(lubridate)
library(jsonlite)
library(rvest)
library(magrittr)
#------------------------------------daily data DOHLCV ----------------------------------------------
source("func.R"); stock_list <- get_stock_num_list("20190429")
source("func.R"); date_set <- get_date_set_all(2010)
file_path <- paste0(getwd(), "/data_DOHLCV/")
# file_name <- paste0(file_path, stock_list[4],".csv")
if(dir.exists(file_path) == FALSE){ dir.create(file_path)}
# source("DOHLCV.R"); update_DOHLCV(date_set[1:4], stock_list[1:4], file_path)
source("DOHLCV.R"); update_DOHLCV_simplify(date_set[1:12], stock_list[1:20], file_path)
file_name <- paste0(file_path,"Volumn.csv")
if(file.exists(file_name)){
############### read files ############################
rcsv <- read.csv(file_name)
# colnames(rcsv) <- c("Date", "Open", "High", "Low", "Close", "Volume", "Value")
colnames(rcsv) <- gsub('X1', replacement = '',colnames(rcsv))
# rcsv <- xts(rcsv[, -1], order.by = as.Date(rcsv[, 1]))
a <- merge(rcsv%>%data.frame, daily_data_1%>%data.frame, all=TRUE)
a%<>%t
a[is.na(a)] <- 0
a%<>%t
colnames(a) %<>% gsub('X', replacement = '',.)
############### update files ############################
source("func.R"); update_rcsv <- xts_update(rcsv_xts, stock_data_1, daily_data_1)
############### write files ############################
sink(file = file_name, append = TRUE)
write.table(update_rcsv, file = file_name, sep=",", row.names = FALSE, col.names = FALSE,append = TRUE)
sink()
} else{
############### write files ############################
sink(file = file_name, append = FALSE)
write.table(daily_data_1, file = file_name, sep=",", row.names = FALSE, append = FALSE)
sink()
}
View(daily_data_1)
View(historyStock)
