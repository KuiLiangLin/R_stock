aaa <- html_text(html_nodes(stats, xpath = paste0('//body//center//center//table//tr//td//table[1]//tr[2]//td//table//tr[3]')))
#install.packages( c("jsonlite", "lubridate", "quantmod"))
library(quantmod)
aaa <- html_text(html_nodes(stats, xpath = paste0('//body//center//center//table//tr//td//table[1]//tr[2]//td//table//tr[3]')))
library(rvest)
aaa <- html_text(html_nodes(stats, xpath = paste0('//body//center//center//table//tr//td//table[1]//tr[2]//td//table//tr[3]')))
stats <- read_html("http://mops.twse.com.tw/nas/t21/sii/t21sc03_107_12_0.html", encoding = 'ISO-8859-1')
aaa <- html_text(html_nodes(stats, xpath = paste0('//body//center//center//table//tr//td//table[1]//tr[2]//td//table//tr[3]')))
aaa <- gsub(',', replacement = '', aaa)
substring(aaa, 139, 142)
substring(aaa, 1, 4)
bbb <- strsplit(aaa, " ")
View(bbb)
grep("[0-9]", aaa)
grep("[0-9]", bbb)
grep("[0-9]", bbb[[1]][1])
bbb[[1]][1]
grep("[ ]", bbb[[1]][1])
grep("[1 ]", bbb[[1]][1])
grep("[0 ]", bbb[[1]][1])
c <- grep("[0-9]", bbb[[1]][1])
c <- grep("[0-9]", bbb[[1]][1], value = TRUE)
c <- grep("[0-9]", bbb[[1]][2], value = TRUE)
c <- grep("[0-9]", bbb[[1]][14], value = TRUE)
is.numeric(c)
bbb[[1]][2]
length(c)
c <- grep("[0-9]", bbb[[1]][2], value = TRUE)
length(c)
d <- NULL
for(i in c(1:1000)){
c <- grep("[0-9]", bbb[[1]][i], value = TRUE)
if(length(c)==1){d <- c(d, c)}
}
d <- NULL
for(i in c(1:1000)){
c <- grep("[0-9]", bbb[[1]][i], value = TRUE)
if(length(c)==1){d <- cbind.data.frame(d, c)}
}
d <- NULL
for(i in c(1:1000)){
c <- grep("[0-9]", bbb[[1]][i], value = TRUE)
if(length(c)==1){d <- cbind(d, c)}
}
View(d)
dim(bbb)
dim(bbb[[1]])
length(bbb[[1]])
bbb[[1]]
bbb[[1]][118]
is.na(bbb[[1]][118])
is.na(bbb[[1]][117])
d <- substring(aaa, 1, 4)
bbb <- strsplit(aaa, " ")
for(i in c(2:length(bbb[[1]]))){
c <- grep("[0-9]", bbb[[1]][i], value = TRUE)
if(length(c)==1){d <- cbind(d, c)}
}
View(d)
aaa <- html_text(html_nodes(stats, xpath = paste0('//body//center//center//table//tr//td//table[1]//tr[2]//td//table')))
aaa <- gsub(',', replacement = '', aaa)
aaa
d <- substring(aaa, 137, 141)
d <- substring(aaa, 138, 141)
d <- NULL
# d <- substring(aaa, 138, 141)
bbb <- strsplit(aaa, " ")
length(bbb[[1]])
for(i in c(1:length(bbb[[1]]))){
c <- grep("[0-9]", bbb[[1]][i], value = TRUE)
if(length(c)==1){d <- cbind(d, c)}
}
View(d)
d[1]
substring(d[1], 138, 141)
substring(d[1], 139, 142)
d[1] <- substring(d[1], 139, 142)
strsplit(d[9], "-")
strsplit(d[9+9], "-")
strsplit(d[9+8], "-")
strsplit(d[9+8*4], "-")
last(strsplit(d[9+8*4], "-"))
last(strsplit(d[9+8*4], "-"))
strsplit(d[9+8*4], "-")[1]
strsplit(d[9+8*4], "-")[[1]][1]
last(strsplit(d[9+8*4], "-")[[1]][1])
last(strsplit(d[9+8*4], "-")[[1]])
length(d)
# d <- substring(aaa, 138, 141)
bbb <- strsplit(aaa, " ")
d <- NULL
for(i in c(1:length(bbb[[1]]))){
c <- grep("[0-9]", bbb[[1]][i], value = TRUE)
if(length(c)==1){d <- cbind(d, c)}
}
View(bbb)
bbb
length(bbb[[1]]))
length(bbb[[1]])
c <- grep("[0-9]", bbb[[1]][988], value = TRUE)
length(c)==1
aaa
d[66]
d[65]
# d[9] <- gsub(',', replacement = '', aaa)
for(j in c(0:(length(d)-9)/8)){
d[9+8*j] <- last(strsplit(d[9+8*j], "-")[[1]])
}
View(d)
d[1] <- substring(d[1], 139, 142)
View(d)
# d <- substring(aaa, 138, 141)
bbb <- strsplit(aaa, " ")
d <- NULL
for(i in c(1:length(bbb[[1]]))){
c <- grep("[0-9]", bbb[[1]][i], value = TRUE)
if(length(c)==1){d <- cbind(d, c)}
}
d[1] <- substring(d[1], 139, 142)
# d[9] <- gsub(',', replacement = '', aaa)
for(j in c(0:(length(d)-9)/8)){
d[9+8*j] <- last(strsplit(d[9+8*j], "-")[[1]])
d[9+8*j] <- substring(d[9+8*j], 139, 142)
}
# d <- substring(aaa, 138, 141)
bbb <- strsplit(aaa, " ")
bbb
d <- NULL
for(i in c(1:length(bbb[[1]]))){
c <- grep("[0-9]", bbb[[1]][i], value = TRUE)
if(length(c)==1){d <- cbind(d, c)}
}
View(d)
d[1] <- substring(d[1], 139, 142)
# d[9] <- gsub(',', replacement = '', aaa)
for(j in c(0:(length(d)-9)/8)){
d[9+8*j] <- last(strsplit(d[9+8*j], "-")[[1]])
d[9+8*j] <- substring(d[9+8*j], 1, 4)
}
f <- c(d[1], d[2])
for(k in c(1:(length(d)-9)/8)){
f <- rbind(f, c(d[1+8*k], d[2+8*k]) )
}
View(f)
d[57]
d[57]
d[56]
d[1]
d[9]
d[17]
c(d[1], d[2])
f <- c(d[1], d[2])
for(k in c(1:(length(d)-9)/8)){
f <- rbind(f, c(d[1+8*k], d[2+8*k]) )
}
View(f)
f <- c(d[1], d[2])
for(k in c(1:(length(d)-9)/8)){
f <- rbind(f, c(d[1+(8*k)], d[2+(8*k)]) )
}
f <- rbind(f, c(d[1+8*k], d[2+8*k]) )
f <- rbind(f, c(d[1+8*k], d[2+8*k]) )
f <- c(d[1], d[2])
f <- rbind(f, c(d[1+8*k], d[2+8*k]) )
f <- c(d[1], d[2])
k <- 2
f <- rbind(f, c(d[1+8*k], d[2+8*k]) )
f <- c(d[1], d[2])
for(k in c(1:(length(d)-9)/8)){
f <- rbind(f, c(d[1+8*k], d[2+8*k]) )
}
f <- c(d[1], d[2])
for(k in c(1:ceiling((length(d)-9)/8)){
for(k in c(1:ceiling((length(d)-9)/8))){
f <- rbind(f, c(d[1+8*k], d[2+8*k]) )
}
View(f)
